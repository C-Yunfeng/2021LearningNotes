#### 一、定位技术

##### 1. 激光点云定位直方图过滤器

![image-20210407210709772](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407210709772.png)



##### 2. 航向角优化，LK算法

![image-20210407210841607](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407210841607.png)

![image-20210407211026387](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407211026387.png)



##### 3. 视觉定位

地图制作

![image-20210407211345116](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407211345116.png)

特征检测

车道线，杆状物

![image-20210407211419956](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407211419956.png)

![image-20210407211736068](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407211736068.png)

![image-20210407211749804](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407211749804.png)





#### 二、传感器

![image-20210407213952926](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407213952926.png)

##### 1. 激光雷达

优点：精度高，主动

缺点：64线，做测距可以，做识别很难。比如远处可能就只有1根线扫到了。而且功率也有限制。约60，70米

##### 2. 相机

优点：稠密的感知，比如1080P，感知很远（不同焦距）

缺点：被动；单目相机，测距不准。

##### 3. 毫米波雷达

优点：测相对速度

缺点：噪点很多；对非金属材质的反射较小。比如金属前走过一个人

##### 4. 安装

雷达放车顶，遮挡较小，比如拥挤路段

不同传感器的视野有一定的overlap才好做融合（标定）

##### 5. 标定

不同传感器坐标系的对齐

> ![image-20210407214725433](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407214725433.png)

相机矫正，长期之后焦距会有变化

标定间

> 算法：根据二维码的3D坐标，标定长焦和短焦
>
> 标定结果可视化：都投到短焦的相机上，如果看的自然，没有重影之后的，则人工check比较好
>
> ![image-20210407215149254](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407215149254.png)

LIDAR和相机的标定

> 3D点投到图像上，看边界是否一致![image-20210407215329741](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407215329741.png)



#### 三、感知算法

![image-20210407215607242](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407215607242.png)

- 传统pipline

  > ![image-20210407225355590](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407225355590.png)

- 局部endtoend

  > 2dto3d，tracking也用CNN来做，让后处理轻量化![image-20210407225435730](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407225435730.png)





##### 1. 点云感知

[雷达视频09:33](https://www.bilibili.com/video/BV1p54y1S7Gb?p=30)

1秒10次，1秒能洒10w多个点，安装高度1.7m

![image-20210407215810841](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407215810841.png)

- 点云分割

> 任务
>
> - 识别哪些点云是障碍物
> - 哪些是人，是车
> - 行为数据，速度
>
> 方法
>
> - 启发式方法NCut：点云检测变为图的分割问题，大的graph变成小的graph，得到cluster，并检测，异常过滤。
>
>   - 解释性很好
>
>   - 规则过于简单，比如两个人手拉手走
>
> - `当人很难再制定一些规则时，需要借助数据驱动的方法，通过机器学习解决`
>
> - CNNSeg论文
>
>   - 把点云投到前向视角（圆柱面）上，构建feature，把点云问题转化为深度学习问题
>   - 需要很多数据，才符合实际情况
>   - bird view丢了高度信息![image-20210407220655008](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407220655008.png)
>
> - LIDAR和camera的融合
>
>   CNN！！！![image-20210407220858593](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407220858593.png)



##### 2. CNN检测【Det】

![image-20210407222619604](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407222619604.png)

> 深度学习模型的评估
>
> - 指标？
> - 是一个问题！！！
>
> 模型输出
>
> - 不仅仅是detection的框框，像3D靠近
> - 要辅助后续处理，输出障碍物的尺寸，大概的朝向
> - 是一个持续的过程，当前帧的检测考虑到历史帧
>
> 环视能力
>
> - 增加camera
> - sensor融合
>
> CNN检测
>
> - AlexNet，VGGNet，ResNet

> 局部end-to-end
>
> 输入是传感器数据，输出是指令
>
> ![image-20210407222441306](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407222441306.png)



比如尾灯，车门是否打开

> 传统方法：
>
> 有一个detection bounding box，做一些规则，比如划定一个区域，判断尾灯是否亮
>
> 深度学习方法：
>
> 让标注员把尾灯的情况标注出来，把所有的信息变成一个属性去训练模型【即收集更多的数据】

比如树，不能用bounding box，而应该提取边缘



可行驶区域的识别，比如没有车道线的地方，识别出障碍物，画出可行驶区域



车道线的分割：

- 做一个mask，提取mask的边缘。（如果是虚线，则做一个聚类，判断是否一个车道线，然后做曲线拟合，然后投到3D场景里
- detection，一行一行扫描点，学习车道线的坐标



##### 3. 后处理

> 仅有深度学习是不够的，后处理直接面向下游做一些修改，对系统的改进帮助特别大。二模型的修改是非常缓慢的，收集数据，重新调模型，而且不一定有效

![image-20210407225157247](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407225157247.png)

1. 2Dto3D的集合计算【2dto3d】

   > - 相机pose的影响
   > - 接地点
   >   - 单目回3D
   > - 2D框
   > - 绝对尺寸：比如都是横向遮挡，学习出障碍物的尺寸，提高回3D的精度

2. 时序信息计算：【tracking跟踪】

   > - 对相机帧率有要求，【比如开车1秒闭眼1秒，不放心】
   > - 延时【必须轻量化】
   > - 输出类别，是人是车，不能跳变

3. 多相机融合

   > 物体切断，不利于回3D



##### 4. 红绿灯案例

> 车上能用GPU吗？功耗太高

![image-20210407230053092](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407230053092.png)

研发过程

> ![image-20210407230221536](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407230221536.png)
>
> - 相机的分辨率要高
>
> - 固定的信息（如红绿灯的边框角点的坐标，灯的语义是左转还是直行）交给高精地图去完成，算法只看颜色
>
> - 判断颜色：深度学习，做颜色分类
>
> - 实际情况的复杂性：许多红绿灯，要看哪一个
>
>   ![image-20210407230558038](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407230558038.png)

##### 5. 开放问题

哪个传感器更好？

![image-20210407231103438](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407231103438.png)

目前LIDAR作用更大，未来希望camera作用更大





##### 6. 感知中的机器学习

![image-20210407234223242](C:\Users\18810\AppData\Roaming\Typora\typora-user-images\image-20210407234223242.png)

> 漏检，误检
>
> 处理Corner case：
>
> - 提高模型泛化能力
> - 限定场景，专项训练



#### 感知的未来

- 仿真

  > - 点云仿真较容易
  > - 动画仿真，游戏行业一直在做

- V2X